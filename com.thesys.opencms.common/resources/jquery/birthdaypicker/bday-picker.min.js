/*
 * jQuery Birthday Picker: v1.4 - 10/16/2011
 * http://abecoffman.com/stuff/birthdaypicker
 *
 * Copyright (c) 2010 Abe Coffman
 * Dual licensed under the MIT and GPL licenses.
 *
 */
(function(f){var a={"short":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"long":["January","February","March","April","May","June","July","August","September","October","November","December"]},b=new Date(),c=b.getFullYear(),e=b.getMonth()+1,d=b.getDate();f.fn.birthdaypicker=function(g){var h={maxAge:120,futureDates:false,maxYear:c,dateFormat:"middleEndian",monthFormat:"short",placeholder:true,legend:"",defaultDate:false,fieldName:"birthdate",fieldId:"birthdate",hiddenDate:true,onChange:null,tabindex:null};return this.each(function(){if(g){f.extend(h,g)}var w=f("<fieldset class='birthday-picker'></fieldset>"),u=f("<select class='birth-year' name='birth[year]'></select>"),t=f("<select class='birth-month' name='birth[month]'></select>"),o=f("<select class='birth-day' name='birth[day]'></select>");if(h.legend){f("<legend>"+h.legend+"</legend>").appendTo(w)}var r=h.tabindex;if(h.dateFormat=="bigEndian"){w.append(u).append(t).append(o);if(r!=null){u.attr("tabindex",r);t.attr("tabindex",r++);o.attr("tabindex",r++)}}else{if(h.dateFormat=="littleEndian"){w.append(o).append(t).append(u);if(r!=null){o.attr("tabindex",r);t.attr("tabindex",r++);u.attr("tabindex",r++)}}else{w.append(t).append(o).append(u);if(r!=null){t.attr("tabindex",r);o.attr("tabindex",r++);u.attr("tabindex",r++)}}}if(h.placeholder){f("<option value='0'>Year:</option>").appendTo(u);f("<option value='0'>Month:</option>").appendTo(t);f("<option value='0'>Day:</option>").appendTo(o)}var p;if(h.defaultDate){var x=new Date(h.defaultDate),n=x.getFullYear(),s=x.getMonth()+1,i=x.getDate();p=n+"-"+s+"-"+i}if(h.hiddenDate){f("<input type='hidden' name='"+h.fieldName+"'/>").attr("id",h.fieldId).val(p).appendTo(w)}var v=c;var y=c-h.maxAge;if(h.futureDates&&h.maxYear!=c){if(h.maxYear>1000){v=h.maxYear}else{v=c+h.maxYear}}while(v>=y){f("<option></option>").attr("value",v).text(v).appendTo(u);v--}for(var q=0;q<12;q++){f("<option></option>").attr("value",q+1).text(a[h.monthFormat][q]).appendTo(t)}for(var m=1;m<32;m++){f("<option></option>").attr("value",m).text(m).appendTo(o)}f(this).append(w);if(h.defaultDate){var l=new Date(h.defaultDate);u.val(l.getFullYear());t.val(l.getMonth()+1);o.val(l.getDate())}w.change(function(){var B=new Date(),F=B.getFullYear(),D=B.getMonth()+1,E=B.getDate(),G=u.val(),z=t.val(),k=o.val(),C=(new Date(G,z,0)).getDate(),A=parseInt(t.children(":last").val()),j=parseInt(o.children(":last").val());if(j>C){while(j>C){o.children(":last").remove();j--}}else{if(j<C){while(j<C){j++;o.append("<option value="+j+">"+j+"</option>")}}}if(!h.futureDates&&G==F){if(A>D){while(A>D){t.children(":last").remove();A--}o.children(":first").attr("selected","selected")}}if(G!=F&&A!=12){while(A<12){t.append("<option value="+(A+1)+">"+a[h.monthFormat][A]+"</option>");A++}}if((G*z*k)!=0){p=G+"-"+z+"-"+k;f(this).find("#"+h.fieldId).val(p);if(h.onChange!=null){h.onChange(p)}}})})}})(jQuery);